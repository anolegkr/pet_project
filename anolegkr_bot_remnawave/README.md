# ü§ñ MyVPN Bot

[![License: MIT](https://img.shields.io/badge/License-MIT-blue.svg)](LICENSE)
[![Python 3.13+](https://img.shields.io/badge/Python-3.13+-3776AB.svg?logo=python)](https://python.org)
[![Docker](https://img.shields.io/badge/Docker-‚úÖ-2496ED.svg?logo=docker)](https://docker.com)
[![Remnawave API](https://img.shields.io/badge/Remnawave-API-green.svg)](https://docs.rw)
[![Code Style: Black](https://img.shields.io/badge/code%20style-black-000000.svg)](https://github.com/psf/black)

> üöÄ –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π Telegram-–±–æ—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è VPN-–ø–æ–¥–ø–∏—Å–∫–∞–º–∏ –Ω–∞ –±–∞–∑–µ Remnawave Panel  
> üîê –ü–æ–ª–Ω–æ—Å—Ç—å—é –Ω–µ–∑–∞–≤–∏—Å–∏–º–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å —á–∏—Å—Ç–æ–≥–æ –ª–∏—Å—Ç–∞ (clean room design)

<p align="center">
  <img src="docs/assets/preview.png" alt="Bot Preview" width="600"/>
</p>

---

## üìã –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ

- [‚ú® –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏](#-–æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏)
- [üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞](#Ô∏è-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)
- [üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç](#-–±—ã—Å—Ç—Ä—ã–π-—Å—Ç–∞—Ä—Ç)
- [‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞](#Ô∏è-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞)
- [üîå –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏](#-–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏)
- [üõ†Ô∏è –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞](#Ô∏è-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞)
- [ü§ù Contributing](#-contributing)
- [üìú –õ–∏—Ü–µ–Ω–∑–∏—è](#-–ª–∏—Ü–µ–Ω–∑–∏—è)
- [üôè –ë–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–∏](#-–±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–∏)

---

## ‚ú® –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

### üéØ –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
| –§—É–Ω–∫—Ü–∏—è | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| üì± **Telegram MiniApp** | –£–¥–æ–±–Ω—ã–π –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø—Ä—è–º–æ –≤ Telegram |
| üí≥ **–ì–∏–±–∫–∞—è –æ–ø–ª–∞—Ç–∞** | CryptoBot, Platega, YooKassa, Stripe (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è) |
| üîë **–ú–≥–Ω–æ–≤–µ–Ω–Ω–∞—è –≤—ã–¥–∞—á–∞** | –ö–ª—é—á–∏ VLESS/Hysteria2/Xray —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã |
| üåç **–ú—É–ª—å—Ç–∏—è–∑—ã—á–Ω–æ—Å—Ç—å** | –†—É—Å—Å–∫–∏–π üá∑üá∫ / English en |
| üìä **–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç** | –°—Ç–∞—Ç—É—Å –ø–æ–¥–ø–∏—Å–∫–∏, —Ç—Ä–∞—Ñ–∏–∫, –ø—Ä–æ–¥–ª–µ–Ω–∏–µ, —Ä–µ—Ñ–µ—Ä–∞–ª—ã |

### ‚öôÔ∏è –î–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
| –§—É–Ω–∫—Ü–∏—è | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| üéõÔ∏è **–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å** | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏, —Ä–∞—Å—Å—ã–ª–∫–∏, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ |
| üîó **Remnawave API** | –ü–æ–ª–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π REST API |
| üìà **–ú–µ—Ç—Ä–∏–∫–∏** | Prometheus/Grafana, –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ JSON |
| üîÑ **Auto-deploy** | Docker Compose + GitHub Actions CI/CD |
| üîê **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** | Rate limiting, –≤–∞–ª–∏–¥–∞—Ü–∏—è, mTLS, secrets management |

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```mermaid
graph LR
    A[Telegram User] --> B[aiogram 3.x Bot]
    B --> C[FastAPI Backend]
    C --> D[(PostgreSQL)]
    C --> E[(Redis Cache)]
    C --> F[Remnawave API]
    C --> G[Payment Providers]
    F --> H[Remnawave Panel]
    G --> I[CryptoBot/Platega]
    
    style A fill:#e1f5fe
    style B fill:#fff9c4
    style C fill:#e8f5e9
    style F fill:#f3e5f5
    style H fill:#ffebee

```
## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
my-vpn-bot/  
‚îú‚îÄ‚îÄ üìÅ app/  
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ core/          # Config, logger, database, security  
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ bot/           # aiogram handlers, keyboards, filters  
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ api/           # FastAPI routers (webhooks, admin)  
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ services/      # Business logic: payments, remnawave, notifications  
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ models/        # SQLAlchemy models + migrations  
‚îÇ   ‚îî‚îÄ‚îÄ üìÅ utils/         # Helpers, validators, i18n  
‚îú‚îÄ‚îÄ üìÅ locales/           # i18n: ru/LC_MESSAGES, en/LC_MESSAGES  
‚îú‚îÄ‚îÄ üìÅ docs/              # Architecture diagrams, API specs  
‚îú‚îÄ‚îÄ üìÅ tests/             # pytest + aiohttp test suite  
‚îú‚îÄ‚îÄ üìÑ docker-compose.yml # Production-ready orchestration  
‚îú‚îÄ‚îÄ üìÑ .env.example       # Configuration template  
‚îú‚îÄ‚îÄ üìÑ pyproject.toml     # Poetry dependencies + linting config  
‚îî‚îÄ‚îÄ üìÑ CREDITS.md         # Third-party attributions  

üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
‚ñ∂Ô∏è –ß–µ—Ä–µ–∑ Docker Compose (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
```
# 1. –ö–ª–æ–Ω–∏—Ä—É–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git clone https://github.com/anolegkr/pet-project/tree/main/telegram_bot_for_remnawave
cd telegram_bot_for_remnawave

# 2. –ù–∞—Å—Ç—Ä–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏–µ
cp .env.example .env
# üëâ –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π .env –ø–æ–¥ —Å–≤–æ–∏ –Ω—É–∂–¥—ã

# 3. –ó–∞–ø—É—Å—Ç–∏ —Å—Ç–µ–∫
docker compose up -d

# 4. –ü—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏
docker compose logs -f bot
```
üêç –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞
```
# –¢—Ä–µ–±—É–µ—Ç—Å—è Python 3.13+ –∏ Poetry
curl -sSL https://install.python-poetry.org | python3 -

poetry install --with dev
poetry run alembic upgrade head
poetry run python -m app.main
```
‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞
üîë –û—Å–Ω–æ–≤–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (.env)
```
# ü§ñ Telegram
BOT_TOKEN=123456:ABC-DEF1234ghIkl-zyx57W2v1u123ew11
ADMIN_IDS=123456789,987654321

# üóÑÔ∏è Database
DATABASE_URL=postgresql+asyncpg://user:pass@postgres:5432/vpnbot
REDIS_URL=redis://redis:6379/0

# üîó Remnawave Integration
REMNAWAVE_API_URL=https://your-panel.domain/api/v1
REMNAWAVE_API_KEY=rw_live_xxxxxxxxxxxxxx
REMNAWAVE_VERIFY_SSL=true

# üí≥ Payments (–≤–∫–ª—é—á–∞–π –Ω—É–∂–Ω—ã–µ)
CRYPTOBOT_TOKEN=xxx
PLATEGA_API_KEY=xxx
# YOOKASSA_SHOP_ID=xxx

# üåê Web & Security
WEBHOOK_URL=https://bot.yourdomain.com/webhook
SECRET_KEY=your-super-secret-jwt-key-here
LOG_LEVEL=INFO
```
üí° –°–æ–≤–µ—Ç: –ò—Å–ø–æ–ª—å–∑—É–π ```openssl rand -hex 32``` –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ SECRET_KEY
üîÑ –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π
```
# –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
docker compose up -d --build

# –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ –ë–î
docker compose exec bot alembic upgrade head

# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥ –±–µ–∑ –¥–∞—É–Ω—Ç–∞–π–º–∞
docker compose exec bot pkill -HUP -f "python -m app"
```
üîå –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
Remnawave API
–ë–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π –ø—É–±–ª–∏—á–Ω—ã–π API Remnawave Panel [docs.rw](https://docs.rw/)]:
```
Endpoint | –ú–µ—Ç–æ–¥ | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ
/api/v1/users | POST | –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
/api/v1/users/{id}/keys | GET | –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π
/api/v1/subscriptions | POST | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–∞–º–∏
/api/v1/stats | GET| –°–±–æ—Ä –º–µ—Ç—Ä–∏–∫ –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏
```
üîê –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è: Bearer Token –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ Authorization
–ü–ª–∞—Ç–µ–∂–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã
```
# –ü—Ä–∏–º–µ—Ä –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –Ω–æ–≤–æ–≥–æ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ (services/payments/base.py)
class PaymentProvider(ABC):
    @abstractmethod
    async def create_invoice(self, amount: float, currency: str, user_id: int) -> Invoice: ...
    
    @abstractmethod
    async def verify_webhook(self, payload: dict, signature: str) -> bool: ...
```
‚úÖ –ì–æ—Ç–æ–≤—ã–µ –∞–¥–∞–ø—Ç–µ—Ä—ã: CryptoBotProvider, PlategaProvider
‚ûï –õ–µ–≥–∫–æ –¥–æ–±–∞–≤–∏—Ç—å: YooKassa, Stripe, Coinbase Commerce

üõ†Ô∏è –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞  
üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
```
# –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Ç–µ—Å—Ç—ã
poetry run pytest

# –° –ø–æ–∫—Ä—ã—Ç–∏–µ–º
poetry run pytest --cov=app --cov-report=html

# –õ–∏–Ω—Ç–∏–Ω–≥
poetry run black . && poetry run ruff check .
```

üåê Webhooks & Proxy
–î–ª—è —Ä–∞–±–æ—Ç—ã webhook'–æ–≤ –∑–∞ reverse proxy (nginx/Caddy):
```
# –ü—Ä–∏–º–µ—Ä nginx location
location /webhook {
    proxy_pass http://bot:8080;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_read_timeout 90;
}
```
üîó –î–æ–º–µ–Ω—ã: –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –º—É–ª—å—Ç–∏–¥–æ–º–µ–Ω–Ω—É—é –Ω–∞—Å—Ç—Ä–æ–π–∫—É (bot., api., miniapp.)
üì¶ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
```
# –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
poetry update --dry-run  # —Å–Ω–∞—á–∞–ª–∞ preview
poetry update           # –∑–∞—Ç–µ–º –ø—Ä–∏–º–µ–Ω–∏—Ç—å

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π
poetry run pip-audit
```
ü§ù Contributing
–ú—ã –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤—É–µ–º –≤–∫–ª–∞–¥ —Å–æ–æ–±—â–µ—Å—Ç–≤–∞! üôå  
Fork —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è  
–°–æ–∑–¥–∞–π feature-–≤–µ—Ç–∫—É (git checkout -b feat/amazing-feature)  
–ö–æ–º–º–∏—Ç—å —Å –ø–æ–Ω—è—Ç–Ω—ã–º–∏ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏ (git commit -m 'feat: add referral system')  
Push –≤ –≤–µ—Ç–∫—É (git push origin feat/amazing-feature)  
–û—Ç–∫—Ä–æ–π Pull Request —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏–π 

üìã Checklist –ø–µ—Ä–µ–¥ PR:  
–ö–æ–¥ –æ—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω (black .)  
–ü—Ä–æ–π–¥–µ–Ω –ª–∏–Ω—Ç–∏–Ω–≥ (ruff check .)  
–î–æ–±–∞–≤–ª–µ–Ω—ã/–æ–±–Ω–æ–≤–ª–µ–Ω—ã —Ç–µ—Å—Ç—ã  
–û–±–Ω–æ–≤–ª–µ–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)  
–í—Å–µ —Ç–µ—Å—Ç—ã –∑–µ–ª—ë–Ω—ã–µ (pytest)  

üìú –õ–∏—Ü–µ–Ω–∑–∏—è
–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ–¥ –ª–∏—Ü–µ–Ω–∑–∏–µ–π MIT ‚Äî —Å–º. —Ñ–∞–π–ª [LICENSE](https://github.com/anolegkr/pet-project/blob/main/LICENSE) –¥–ª—è –¥–µ—Ç–∞–ª–µ–π.  
```
‚ö†Ô∏è –í–∞–∂–Ω–æ: –î–∞–Ω–Ω—ã–π –ø—Ä–æ–µ–∫—Ç —è–≤–ª—è–µ—Ç—Å—è –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–µ–π –∏ –Ω–µ –∞—Ñ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω —Å Remnawave –∏–ª–∏ BEDOLAGA-DEV.
–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Remnawave Panel –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ —á–µ—Ä–µ–∑ –ø—É–±–ª–∏—á–Ω—ã–π API —Å–æ–≥–ª–∞—Å–Ω–æ –∏—Ö –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏.
```
  üîç –ß—Ç–æ —ç—Ç–æ –∑–Ω–∞—á–∏—Ç –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ?
| ‚úÖ –ú–æ–∂–Ω–æ | ‚ùå –ù–µ–ª—å–∑—è (–±–µ–∑ –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ —Å–æ–≥–ª–∞—à–µ–Ω–∏—è)
|----------|----------|
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–æ—Ç–∞ –¥–ª—è —Å–µ–±—è / —Å–≤–æ–µ–π –∫–æ–º–∞–Ω–¥—ã | –ü—Ä–æ–¥–∞–≤–∞—Ç—å –±–æ—Ç–∞ –∫–∞–∫ SaaS-—Å–µ—Ä–≤–∏—Å
–ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥ –ø–æ–¥ —Å–≤–æ–∏ –Ω—É–∂–¥—ã | –ë—Ä–∞—Ç—å –ø–ª–∞—Ç—É –∑–∞ —Ö–æ—Å—Ç–∏–Ω–≥ "–Ω–∞ –±–∞–∑–µ —ç—Ç–æ–≥–æ –±–æ—Ç–∞"
–î–µ–ª–∏—Ç—å—Å—è —Ñ–æ—Ä–∫–∞–º–∏ —Å —Å–æ–æ–±—â–µ—Å—Ç–≤–æ–º (–±–µ—Å–ø–ª–∞—Ç–Ω–æ) | –û–∫–∞–∑—ã–≤–∞—Ç—å –ø–ª–∞—Ç–Ω—É—é –ø–æ–¥–¥–µ—Ä–∂–∫—É/–∫–æ–Ω—Å–∞–ª—Ç–∏–Ω–≥ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–æ–¥–∞
–ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ —Å–≤–æ–∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç—ã | –í–∫–ª—é—á–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –±–æ—Ç–∞ –≤ –∫–æ–º–º–µ—Ä—á–µ—Å–∫–∏–π –ø—Ä–æ–¥—É–∫—Ç


